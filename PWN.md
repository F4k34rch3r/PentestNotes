# 环境配置

```
#配置Kali的docker容器

#下载kali镜像
docker pull kalilinux/kali-rolling --platform linux/amd64
【如果不带参数，默认使用arm版aarch64】
#启动容器
docker run --privileged --cap-add=SYS_PTRACE --security-opt seccomp=unconfined -itd -p 22:22 kalilinux/kali-rolling

#进入容器，配置兼容32位程序
docker exec -it 1b93 /bin/bash
dpkg --add-architecture i386

#设置国内源
echo "# 官方源
# deb http://http.kali.org/kali kali-rolling main non-free contrib
# deb-src http://http.kali.org/kali kali-rolling main non-free contrib
#根据需要自己选一个，中科大的还可以
#中科大
deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib
deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib
#阿里云
#deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib
#deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib
#清华大学
#deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free
#deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free
#浙大
#deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free
#deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free
#东软大学
#deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib
#deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib
#重庆大学
#deb http://http.kali.org/kali kali-rolling main non-free contrib
#deb-src http://http.kali.org/kali kali-rolling main non-free contrib" > /etc/apt/source.list

#安装依赖
apt-get update
# apt-get install python2 python3 python2-dev python3-dev python3-pip git cmake gcc clang libncurses5-dev qemu-user-static libssl-dev libffi-dev build-essential curl
apt-get install python3 python3-dev python3-pip git cmake gcc libncurses5-dev libssl-dev libffi-dev build-essential curl qemu-user-static

#安装unicorn
python3 -m pip install unicorn==1.0.2rc1
git clone https://github.com/pwndbg/pwndbg
cd pwndbg
./setup.sh

#安装peda
git clone https://github.com/longld/peda.git ~/peda
echo "source ~/peda/peda.py" >> ~/.gdbinit

#安装pwntools
python3 -m pip install --upgrade pip
python3 -m pip install --upgrade git+https://github.com/Gallopsled/pwntools.git@dev

#编译安装vim
git clone https://github.com/vim/vim.git
cd vim/src
./configure --with-features=huge --enable-pythoninterp=yes --enable-cscope --enable-fontset --enable-python3interp=yes --with-python-config-dir=/usr/lib/python3.11/config-3.11-x86_64-linux-gnu/ --enable-multibyte --prefix=/usr/local/vim/
make
make install

/usr/local/vim/bin/vim ~/.bashrc
在最后加上一行：
export PATH=$PATH:/usr/local/vim/bin/
alias sudo='sudo env PATH=$PATH'
然后 source .bashrc 使配置生效

#配置vim，安装自动补全插件
curl -fLo ~/.vim/autoload/plug.vim --create-dirs   https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

vim ~/.vimrc 

call plug#begin('~/.vim/plugged')
Plug 'Valloric/YouCompleteMe'
call plug#end()
" F5 运行
map <F5> :call CompileRunGcc()<CR>
func! CompileRunGcc()
    exec "w" 
    if &filetype == 'c' 
        exec "!g++ % -o %<"
        exec "!./%<"
    elseif &filetype == 'cpp'
        exec "!g++ % -o %<"
        exec "!./%<"
    elseif &filetype == 'java' 
        exec "!javac %" 
        exec "!java %<"
    elseif &filetype == 'sh'
        :!time bash %
    elseif &filetype == 'python'
        exec "!python3 %"
    elseif &filetype == 'html'
        exec "!firefox % &"
    elseif &filetype == 'php'
        exec "!php % &"
    elseif &filetype == 'go'
        exec "!go build %<"
        exec "!go run %"
    elseif &filetype == 'mkd'
        exec "!~/.vim/markdown.pl % > %.html &"
        exec "!firefox %.html &"
    endif
endfunc

打开vim，输入 :PlugInstall 初步安装插件【可能部分失败】

cd ~/.vim/plugged/YouCompleteMe/
python3 install.py --force-sudo

#将配置好的容器做成镜像，上传至dockerhub
docker commit -a "F4k34rch3r" -m "pwntools" -p 1b93 kalipwntools:v1
docker login
docker tag kalipwntools:v1 f4k34rch3r/kalipwntools4applesilicon:0.1
docker push f4k34rch3r/kalipwntools4applesilicon:0.1
```

